---
title: "mp-bib-coupling"
author: "Brie Sherow"
date: "15/07/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load library, include=FALSE}
library(bibliometrix)
library(tidyverse)
library(ggplot2)
library(data.table)
```


```{r upload data, eval=TRUE}
getwd()
# bib <- convert2df(file = c("./data/scopus2015-2017.bib"), dbsource = "scopus", format = "bibtex") # Convert to a bibliometric data frame

# bib <- convert2df(file = c("./data/scopus2018-2019.bib","./data/scopus2015-2017.bib", "./data/scopus2011-2014.bib","./data/scopus2006-2010.bib", "./data/scopus1999-2005.bib","./data/scopus1970-1998.bib"), dbsource = "scopus", format = "bibtex") # Convert to a bibliometric data frame

#write.csv(bib, "output/bib_as_df.csv", row.names = FALSE) #save this data frame as a csv file

# save(bib, file = "./data/bib.RData") #save this data frame as a RData file (object)
load(file = "./data/bib.RData") #to load this data frame from a RData file (returns an object named "bib")
```
```{r analysis and summary}
results <- biblioAnalysis(bib, sep=";")

options(width=100)
S <- summary(object = results, k = 10, pause = FALSE)

load(file = "./data/results.RData") #to load this data frame from a RData file (returns both results and summary)
```


```{r analysis and summary}
#total articles published per year
annual_prod <- print(S$AnnualProduction)
names(annual_prod)[1] <- "Year"
as.numeric(annual_prod$Year)

#Left intentionally blank in order to annotate
  ggplot(annual_prod, aes(Year, Articles)) +
          geom_point() +
          geom_line() +
          labs(title = "Marine Pollution Research", subtitle = "per year", x="Year", y="Total Articles Published") +
          scale_x_discrete(breaks = seq(1970, 2019, by = 5)) +
          theme(axis.text.x = element_text(size = 12, angle = 90),
                axis.text.y = element_text(size = 12),
                panel.background = element_blank())
  
  ?theme
  

  
ggsave(filename="figures/papers_per_year.png", width=11, height=9.5)
  
```


##The top 10 most cited papers are all about plastics
```{r  most cited papers, eval=TRUE}
#top ten most cited papers
mostcitedP <- citations(bib, field = "article", sep = ";")
top10cited <- cbind(mostcitedP$Cited[1:10], mostcitedP$Year[1:10]) #first 10
top10cited <- as.data.frame(top10cited)
top10cited <- setDT(top10cited, keep.rownames = "papers")


write.csv(bib, "output/top10cited.csv", row.names = FALSE) #save this data frame as a csv file

```
